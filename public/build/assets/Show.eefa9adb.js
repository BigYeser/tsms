import{m as N}from"./md5.2ef7b393.js";import{L as O,D as T}from"./Dropdown.b210fc33.js";import{D as B}from"./Dialog.c58b48bf.js";import{M as P}from"./Modal.92c1c07f.js";import{S as R}from"./SmsDialog.4589144c.js";import j from"./Show.861a97f5.js";import{_ as A,r as h,o as n,c as d,a as t,t as s,f as x,e as p,d as a,b as u,h as c,n as k,F as y,j as f}from"./app.27628006.js";import"./LoadingButton.c99c7352.js";import"./TextareaInput.9cfbbfd1.js";import"./InputError.5bf8b5c3.js";const L={metaInfo(){return{title:this.$t("Order Number",{x:this.order.id})}},props:{order:{default:{}},modal:{default:!0},edit:{type:Function}},components:{Logo:O,Dropdown:T,Dialog:B,Modal:P,MeasurementComponent:j,SmsDialog:R},computed:{total_paid:function(){return this.$number(this.order.payments.reduce((e,o)=>e+parseFloat(o.amount),0))}},data(){return{sending:!1,confirm:!1,send_sms:!1,emailing:!1,message:null,dialogButtonText:null,dialogAction:null,dialogTitle:null,dialogBody:null,viewMeasurement:!1}},methods:{showMeasurement(e){fetch(this.route("measurements.show",[e.id,N.exports(e.name)])+"?ajax=1").then(o=>{o.json().then(r=>{this.measurement=r,this.viewMeasurement=!0})})},printOrder(){window.print()},editOrder(){this.$emit("close"),this.$inertia.get(route("orders.edit",this.order.id))},updateStatusNow(e){this.$emit("close"),this.$inertia.put(this.route("orders.status",this.order.id),{status:e})},updateStatus(e){this.order.status=="Completed"?this.message=this.$t("Order is already marked as completed."):(this.dialogButtonText=this.$t("Yes"),this.dialogAction=()=>this.updateStatusNow(e),this.dialogTitle=this.$t("update_status_x",{x:this.$t(e)}),this.dialogBody=this.$t("ask_update_status_x",{x:this.$t(e)}),this.confirm=!0)},smsToCustomer(){this.send_sms=!0},emailOrder(){this.sending=!0,this.emailing=!0,this.$axios.post(this.route("orders.email",this.order.id)).then(e=>{this.sending=!1,this.emailing=!1,this.message=e.data.message||this.$t("System is unable to sent email, either customer do not have email or system settings are not correct.")}).catch(e=>{this.sending=!1,this.emailing=!1,this.message=e.response.data.message||this.$t("Request has been failed, please check the logs in storage folder and contact developer.")})},hide(){this.$emit("close")}}},V={key:0,class:"w-full ltr:text-left rtl:text-right"},E={key:0,class:"np flex justify-between items-center px-6 py-4 mb-4 bg-gray-100 border-b rounded-t"},F={class:"font-bold"},I={class:"flex items-center"},q={class:"modal-close mx-2 cursor-pointer text-gray-700 hover:text-gray-800"},z={class:"mt-2 py-2 bg-gray-800 rounded text-sm"},G=["disabled"],H=t("svg",{class:"fill-current text-black",xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 18 18"},[t("path",{d:"M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"})],-1),Q=[H],U={class:"print"},Y={class:"max-w-2xl h-full py-4 px-6 leading-normal"},J={class:"flex flex-wrap xs:flex-no-wrap justify-around w-full items-center"},K={class:"text-gray-900 mx-auto xs:mx-0",style:{width:"180px"}},W=["alt","src"],X={class:"text-sm px-4 py-4 xs:py-0 text-center xs:ltr:text-left rtl:text-right"},Z={class:"font-extrabold"},tt={class:"font-bold"},et={class:"text-sm"},st={class:"flex"},rt={class:"ltr:text-right rtl:text-left ltr:mr-2 rtl:ml-2",style:{width:"70px"}},ot={class:"font-bold"},lt={class:"flex"},nt={class:"ltr:text-right rtl:text-left ltr:mr-2 rtl:ml-2",style:{width:"70px"}},dt={class:"font-bold"},at={class:"inline-block"},it={class:"inline-block"},mt={class:"flex"},ut={class:"ltr:text-right rtl:text-left ltr:mr-2 rtl:ml-2",style:{width:"70px"}},ht={class:"font-bold"},ct={key:0,class:"my-6 px-4 py-3 border rounded"},gt={class:"font-extrabold inline-block"},pt={class:"font-extrabold inline-block"},bt={class:"font-extrabold inline-block"},yt=["href"],xt={id:"details",class:"block xs:flex my-6"},ft={id:"company",class:"ltr:pr-0 rtl:pl-0 xs:ltr:pr-3 xs:rtl:pl-3 w-full xs:max-w-1/2"},_t={class:"px-2 py-2 border rounded-t font-bold"},vt={class:"border rounded-b border-t-0 px-2 py-2"},wt={class:"flex"},kt={class:"ltr:text-right rtl:text-left ltr:mr-2 rtl:ml-2",style:{"min-width":"70px"}},Ct={key:0,class:"flex"},$t={class:"ltr:text-right rtl:text-left ltr:mr-2 rtl:ml-2",style:{"min-width":"70px"}},St={class:"flex"},Dt={class:"ltr:text-right rtl:text-left ltr:mr-2 rtl:ml-2",style:{"min-width":"70px"}},Mt={key:1,class:"flex"},Nt={class:"ltr:text-right rtl:text-left ltr:mr-2 rtl:ml-2",style:{"min-width":"70px"}},Ot={id:"customer",class:"mt-4 xs:mt-0 ltr:pl-0 rtl:pr-0 xs:ltr:pl-3 xs:rtl:pr-3 w-full xs:max-w-1/2"},Tt={class:"px-2 py-2 border rounded-t font-bold"},Bt={class:"border rounded-b border-t-0 px-2 py-2"},Pt={class:"flex"},Rt={class:"ltr:text-right rtl:text-left ltr:mr-2 rtl:ml-2",style:{"min-width":"70px"}},jt={key:0,class:"flex"},At={class:"ltr:text-right rtl:text-left ltr:mr-2 rtl:ml-2",style:{"min-width":"70px"}},Lt={class:"flex"},Vt={class:"ltr:text-right rtl:text-left ltr:mr-2 rtl:ml-2",style:{"min-width":"70px"}},Et={key:1,class:"flex"},Ft={class:"ltr:text-right rtl:text-left ltr:mr-2 rtl:ml-2",style:{"min-width":"70px"}},It={class:"border rounded leading-tight"},qt={class:"px-4 py-3 border-b rounded-t font-bold"},zt={class:"rounded-b overflow-x-auto scroll-on-light"},Gt={class:"w-full all max-w-full min-w-0"},Ht={class:"border-b bg-gray-200 px-4 py-2"},Qt={class:"border-b bg-gray-200 px-4 py-2 text-center"},Ut={class:"border-b bg-gray-200 px-4 py-2 text-center"},Yt={class:"border-b bg-gray-200 px-4 py-2 text-center"},Jt={class:"border-b px-4 py-2"},Kt={style:{"min-width":"180px"}},Wt={class:"text-muted"},Xt=["onClick"],Zt={class:"border-b px-4 py-2 ltr:text-right rtl:text-left"},te={class:"border-b px-4 py-2 ltr:text-right rtl:text-left"},ee={class:"border-b px-4 py-2 ltr:text-right rtl:text-left"},se={colspan:"3",class:"border-b px-4 py-2 bg-gray-200 ltr:text-right rtl:text-left"},re={class:"border-b px-4 py-2 bg-gray-200 ltr:text-right rtl:text-left"},oe={key:0},le={class:"border-b px-4 py-2 bg-gray-200 ltr:text-right rtl:text-left",colspan:"3"},ne={class:"border-b px-4 py-2 bg-gray-200 ltr:text-right rtl:text-left"},de={class:"border-b px-4 py-2 bg-gray-200 ltr:text-right rtl:text-left",colspan:"3"},ae={class:"border-b px-4 py-2 bg-gray-200 ltr:text-right rtl:text-left"},ie={key:2},me={class:"border-b px-4 py-2 bg-gray-200 ltr:text-right rtl:text-left",colspan:"3"},ue={class:"border-b px-4 py-2 bg-gray-200 ltr:text-right rtl:text-left"},he={class:"border-b px-4 py-2 bg-gray-200 ltr:text-right rtl:text-left font-normal",colspan:"3"},ce={class:"border-b px-4 py-2 bg-gray-200 ltr:text-right rtl:text-left font-normal"},ge={class:"border-b px-4 py-2 bg-gray-200 ltr:text-right rtl:text-left",colspan:"3"},pe={class:"border-b px-4 py-2 bg-gray-200 ltr:text-right rtl:text-left"},be={class:"pt-6"},ye={class:"font-bold"},xe={class:"print-only mt-auto w-full text-center text-sm text-gray-600 pt-6"},fe={key:1,class:"np block xs:flex items-end justify-between px-6 py-4 mt-4 bg-gray-100 border-t rounded-b"},_e={class:"m-1 xs:m-0"},ve=["disabled"],we={key:0,class:"btn-spinner dark ltr:mr-2 rtl:ml-2"},ke=["disabled"],Ce={key:0,class:"btn-spinner dark ltr:mr-2 rtl:ml-2"},$e={class:"flex items-center cursor-pointer select-none group px-4 py-3 text-sm rounded bg-gray-200 hover:bg-gray-400 border ltr:mr-2 rtl:ml-2"},Se={class:"mb-2 py-2 bg-gray-800 rounded text-sm"};function De(e,o,r,Me,i,m){var w;const g=h("Icons"),C=h("Dropdown"),$=h("logo"),S=h("dropdown"),D=h("MeasurementComponent"),_=h("Modal"),M=h("SmsDialog"),v=h("Dialog");return r.order&&r.order.id?(n(),d("div",V,[r.modal?(n(),d("div",E,[t("p",F,s(e.$t("Order Number",{x:r.order.id})),1),t("div",I,[r.order.status!="Completed"&&(e.$page.props.user.edit_all||e.$page.props.user.id==((w=r.order.user)==null?void 0:w.id))?(n(),x(C,{key:0,placement:"bottom-end"},{dropdown:p(()=>[t("div",z,[t("button",{type:"button",onClick:o[0]||(o[0]=l=>m.updateStatus("Preparing")),class:"block w-full ltr:text-left rtl:text-right px-6 py-3 text-white hover:bg-gray-900 hover:text-white"},s(e.$t("mark_as_x",{x:e.$t("Preparing")})),1),t("button",{type:"button",onClick:o[1]||(o[1]=l=>m.updateStatus("Ready")),class:"block w-full ltr:text-left rtl:text-right px-6 py-3 text-white hover:bg-gray-900 hover:text-white"},s(e.$t("mark_as_x",{x:e.$t("Ready")})),1),t("button",{type:"button",onClick:o[2]||(o[2]=l=>m.updateStatus("Completed")),class:"block w-full ltr:text-left rtl:text-right px-6 py-3 text-white hover:bg-gray-900 hover:text-white"},s(e.$t("mark_as_x",{x:e.$t("Completed")})),1)])]),default:p(()=>[t("div",q,[u(g,{class:"w-5 h-5 fill-current",name:"scissors"})])]),_:1})):a("",!0),t("a",{onClick:o[3]||(o[3]=l=>m.printOrder()),class:"modal-close mx-2 cursor-pointer text-gray-700 hover:text-gray-800"},[u(g,{name:"printer",class:"h-5 w-5 fill-current"})]),e.$page.props.user.edit_all||e.$page.props.user.id==r.order.user.id?(n(),d("a",{key:1,onClick:o[4]||(o[4]=l=>m.editOrder(r.order.id)),class:"modal-close mx-2 cursor-pointer text-gray-700 hover:text-gray-800"},[u(g,{name:"pencil",class:"h-5 w-5 fill-current"})])):a("",!0),e.$page.props.user.account.sms_enabled&&(e.$page.props.user.can_sms||e.$page.props.user.owner)?(n(),d("a",{key:2,onClick:o[5]||(o[5]=l=>m.smsToCustomer()),class:"modal-close mx-2 cursor-pointer text-gray-700 hover:text-gray-800"},[u(g,{name:"sms",class:"h-5 w-5 fill-current"})])):a("",!0),t("button",{type:"button",disabled:i.emailing,onClick:o[6]||(o[6]=l=>m.emailOrder()),class:"modal-close mx-2 cursor-pointer text-gray-700 hover:text-gray-800"},[u(g,{name:"email",class:"h-5 w-5 fill-current"})],8,G),t("a",{class:"modal-close ml-2 cursor-pointer",onClick:o[7]||(o[7]=l=>m.hide())},Q)])])):a("",!0),t("div",U,[t("div",Y,[t("div",J,[t("div",K,[e.$page.props.user.account.logo_path?(n(),d("img",{key:0,alt:e.$page.props.user.account.name,src:e.$page.props.user.account.logo_path},null,8,W)):(n(),x($,{key:1}))]),t("div",X,[t("div",Z,s(r.order.account.name),1),t("div",tt,s(r.order.account.phone),1),c(" "+s(r.order.account.email),1)]),t("div",et,[t("div",st,[t("span",rt,s(e.$t("Order No"))+":",1),t("span",ot,s(r.order.id),1)]),t("div",lt,[t("span",nt,s(e.$t("Date"))+":",1),t("span",dt,[t("span",at,s(e.$date(r.order.created_at)),1),t("span",it,s(e.$time(r.order.created_at)),1)])]),t("div",mt,[t("span",ut,s(e.$t("Reference"))+":",1),t("span",ht,s(e.$reference(r.order.reference)),1)])])]),r.order.account.header?(n(),d("div",ct,s(r.order.account.header),1)):a("",!0),t("div",{class:k(["my-6 px-4 py-3 rounded text-sm flex justify-between",{"bg-gray-200":r.order.status==e.$t("Received"),"bg-indigo-200":r.order.status==e.$t("Preparing"),"bg-green-200":r.order.status==e.$t("Ready"),"bg-green-700 text-white":r.order.status==e.$t("Completed")}])},[t("div",null,[c(s(e.$t("Priority"))+": ",1),t("span",gt,s(r.order.priority==3?e.$t("Urgent"):r.order.priority==2?e.$t("High"):e.$t("Normal")),1)]),t("div",null,[c(s(e.$t("Status"))+": ",1),t("span",pt,s(r.order.status),1)]),t("div",null,[c(s(e.$t("Delivery Date"))+": ",1),t("span",bt,s(e.$date(r.order.delivery_date)),1)])],2),r.order.photo_path?(n(),d("a",{key:1,target:"_blank",class:"np w-full block my-6 px-4 py-3 rounded border bg-gray-200 hover:bg-gray-300",href:`/img/${r.order.photo_path}?ref=${e.$page.props.user?e.$page.props.user.id+"_"+r.order.hash:r.order.hash}`},s(e.$t("View Order Photo")),9,yt)):a("",!0),t("div",xt,[t("div",ft,[t("div",_t,s(e.$t("Company Details")),1),t("div",vt,[t("div",wt,[t("span",kt,s(e.$t("Name"))+":",1),t("span",null,[t("strong",null,s(r.order.account.name),1)])]),r.order.account.address?(n(),d("div",Ct,[t("span",$t,s(e.$t("Address"))+":",1),t("span",null,s(r.order.account.address),1)])):a("",!0),t("div",St,[t("span",Dt,s(e.$t("Phone"))+":",1),t("span",null,s(r.order.account.phone),1)]),r.order.account.email?(n(),d("div",Mt,[t("span",Nt,s(e.$t("Email"))+":",1),t("span",null,s(r.order.account.email),1)])):a("",!0)])]),t("div",Ot,[t("div",Tt,s(e.$t("Customer Details")),1),t("div",Bt,[t("div",Pt,[t("span",Rt,s(e.$t("Name"))+":",1),t("span",null,[t("strong",null,s(r.order.customer.name),1)])]),r.order.customer.address?(n(),d("div",jt,[t("span",At,s(e.$t("Address"))+":",1),t("span",null,s(r.order.customer.address),1)])):a("",!0),t("div",Lt,[t("span",Vt,s(e.$t("Phone"))+":",1),t("span",null,s(r.order.customer.phone),1)]),r.order.customer.email?(n(),d("div",Et,[t("span",Ft,s(e.$t("Email"))+":",1),t("span",null,s(r.order.customer.email),1)])):a("",!0)])])]),t("div",It,[t("p",qt,s(e.$tc("Service",2)),1),t("div",zt,[t("table",Gt,[t("thead",null,[t("tr",null,[t("th",Ht,s(e.$t("Item / Details")),1),t("th",Qt,s(e.$t("Price")),1),t("th",Ut,s(e.$t("Qty")),1),t("th",Yt,s(e.$t("Amount")),1)])]),t("tbody",null,[(n(!0),d(y,null,f(r.order.services,l=>(n(),d("tr",{key:"service_"+l.id},[t("td",Jt,[t("div",Kt,[t("div",null,s(l.name)+" ("+s(l.code)+")",1),t("div",null,[t("small",Wt,[c(s(e.$tc("Measurement"))+": ",1),t("button",{class:"text-indigo-600 hover:fonr-bold",onClick:b=>m.showMeasurement(l.measurement)},s(l.measurement.name),9,Xt)])])])]),t("td",Zt,s(e.$number(l.price)),1),t("td",te,s(e.$number(l.qty)),1),t("td",ee,s(e.$number(l.amount)),1)]))),128))]),t("tfoot",null,[t("tr",null,[t("th",se,s(e.$t("Total")),1),t("th",re,s(e.$number(r.order.total)),1)]),r.order.discount?(n(),d("tr",oe,[t("th",le,s(e.$t("Discount")),1),t("th",ne,s(e.$number(r.order.discount_amount)),1)])):a("",!0),r.order.taxes.length?(n(!0),d(y,{key:1},f(r.order.taxes,(l,b)=>(n(),d("tr",{key:"tr_"+b},[t("th",de,s(l.name),1),t("th",ae,s(e.$number(l.pivot.total_amount)),1)]))),128)):a("",!0),r.order.taxes.length||r.order.discount?(n(),d("tr",ie,[t("th",me,s(e.$t("Grand Total")),1),t("th",ue,s(e.$number(r.order.grand_total)),1)])):a("",!0),r.order.payments.length?(n(),d(y,{key:3},[(n(!0),d(y,null,f(r.order.payments,(l,b)=>(n(),d("tr",{key:"payment_"+b},[t("th",he,s(e.$tc("Payment"))+" ("+s(e.$date(l.date))+") ",1),t("th",ce,s(e.$number(l.amount)),1)]))),128)),t("tr",null,[t("th",ge,s(e.$t("Balance")),1),t("th",pe,s(e.$number(r.order.grand_total-this.total_paid)),1)])],64)):a("",!0)])])])]),t("div",be,[t("h4",ye,s(e.$t("Comment / Note")),1),t("p",null,s(r.order.note),1)]),r.order.account.footer?(n(),d("div",{key:2,class:k(["mt-6 px-4 py-3 border rounded",r.modal?"":"mb-3"])},s(r.order.account.footer),3)):a("",!0),t("div",xe,s(e.$t("This is a computer-generated document. No signature is required.")),1)])]),r.modal?(n(),d("div",fe,[t("div",_e,[e.$page.props.user.edit_all||e.$page.props.user.id==r.order.user.id?(n(),d("button",{key:0,onClick:o[8]||(o[8]=l=>m.editOrder()),class:"px-4 py-3 text-sm rounded bg-gray-200 hover:bg-gray-400 border ltr:mr-2 rtl:ml-2"},s(e.$t("Edit")),1)):a("",!0),e.$page.props.user.account.sms_enabled&&(e.$page.props.user.can_sms||e.$page.props.user.owner)?(n(),d("button",{key:1,disabled:i.sending,onClick:o[9]||(o[9]=l=>m.smsToCustomer()),class:"inline-flex items-center mt-1 px-4 py-3 text-sm rounded bg-gray-200 hover:bg-gray-400 border ltr:mr-2 rtl:ml-2"},[i.sending?(n(),d("div",we)):a("",!0),c(" "+s(e.$t("SMS")),1)],8,ve)):a("",!0),t("button",{disabled:i.sending,onClick:o[10]||(o[10]=l=>m.emailOrder()),class:"inline-flex items-center mt-1 px-4 py-3 text-sm rounded bg-gray-200 hover:bg-gray-400 border ltr:mr-2 rtl:ml-2"},[i.sending?(n(),d("div",Ce)):a("",!0),c(" Notify ")],8,ke),r.order.status!="Completed"&&(e.$page.props.user.edit_all||e.$page.props.user.id==r.order.user.id)?(n(),x(S,{key:2,class:"mt-1",placement:"top-start"},{dropdown:p(()=>[t("div",Se,[t("button",{type:"button",onClick:o[11]||(o[11]=l=>m.updateStatus("Completed")),class:"block w-full ltr:text-left rtl:text-right px-6 py-3 text-white hover:bg-gray-900 hover:text-white"},s(e.$t("mark_as_x",{x:e.$t("Completed")})),1),t("button",{type:"button",onClick:o[12]||(o[12]=l=>m.updateStatus("Ready")),class:"block w-full ltr:text-left rtl:text-right px-6 py-3 text-white hover:bg-gray-900 hover:text-white"},s(e.$t("mark_as_x",{x:e.$t("Ready")})),1),t("button",{type:"button",onClick:o[13]||(o[13]=l=>m.updateStatus("Preparing")),class:"block w-full ltr:text-left rtl:text-right px-6 py-3 text-white hover:bg-gray-900 hover:text-white"},s(e.$t("mark_as_x",{x:e.$t("Preparing")})),1)])]),default:p(()=>[t("div",$e,[c(s(e.$t("Status"))+" ",1),u(g,{class:"w-2 h-2 fill-current ml-2",name:"cheveron-up"})])]),_:1})):a("",!0)]),t("button",{onClick:o[14]||(o[14]=l=>m.hide()),class:"btn-gray"},s(e.$t("Close")),1)])):a("",!0),u(_,{show:i.viewMeasurement,"max-width":"2xl",closeable:!0,onClose:o[16]||(o[16]=l=>i.viewMeasurement=!1)},{default:p(()=>{var l;return[u(D,{measurement:e.measurement,onClose:o[15]||(o[15]=()=>i.viewMeasurement=!1),notify:r.order.customer.id!=((l=e.measurement)==null?void 0:l.customer.id)},null,8,["measurement","notify"])]}),_:1},8,["show"]),u(_,{show:i.send_sms,"max-width":"sm",closeable:!1,onClose:o[18]||(o[18]=l=>i.send_sms=!1)},{default:p(()=>[u(M,{order:r.order,onClose:o[17]||(o[17]=()=>i.send_sms=!1)},null,8,["order"])]),_:1},8,["show"]),u(v,{show:i.message,content:i.message,close:()=>i.message=null},null,8,["show","content","close"]),u(v,{show:i.confirm,close:()=>i.confirm=!1,"action-text":i.dialogButtonText,action:i.dialogAction,title:i.dialogTitle,content:i.dialogBody},null,8,["show","close","action-text","action","title","content"])])):a("",!0)}const Ee=A(L,[["render",De]]);export{Ee as default};
